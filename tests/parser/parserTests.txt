!! options
version=2
parsoid-compatible=wt2html
!! end

# Force the test runner to ensure the extension is loaded
!! hooks
maplink
!! endhooks

!! test
<maplink>
!! wikitext
<maplink />
<maplink latitude=10 longitude=20 zoom=13 text='Foo &amp; bar'/>
!! html/php
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl">0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20">Foo &amp; bar</a>
</p>
!! html/parsoid
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{}}'>0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" typeof="mw:Extension/maplink" about="#mwt4" data-mw='{"name":"maplink","attrs":{"latitude":"10","longitude":"20","zoom":"13","text":"Foo &amp; bar"}}'>Foo &amp; bar</a></p>
!! end

!! test
<maplink> - HTML sanitization
!! wikitext
<maplink latitude=10 longitude=20 zoom=13 text='<&'/>
!! html/php
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20">&lt;&amp;</a>
</p>
!! html/parsoid
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"latitude":"10","longitude":"20","zoom":"13","text":"&lt;&amp;"}}'>&lt;&amp;</a></p>
!! end

!! test
<maplink> - counters and markers
!! wikitext
<maplink latitude=10.123 longitude=20.456 zoom=13 text='Foo'>
{
"type": "Feature",
	"geometry": {
		"type": "Point",
		"coordinates": [-122, 37]
	},
	"properties": {
		"marker-symbol": "-number"
	}
}
</maplink>

<maplink latitude=10 longitude=20 zoom=13>
{
"type": "Feature",
	"geometry": {
		"type": "Point",
		"coordinates": [-122, 37]
	},
	"properties": {
		"marker-symbol": "-number"
	}
}
</maplink>

<maplink latitude=10 longitude=20 zoom=13>
{
"type": "Feature",
	"geometry": {
		"type": "Point",
		"coordinates": [-122, 37]
	},
	"properties": {
		"marker-symbol": "-letter"
	}
}
</maplink>

<maplink latitude=10 longitude=20 zoom=13 mapstyle=osm>
{
"type": "Feature",
	"geometry": {
		"type": "Point",
		"coordinates": [-122, 37]
	},
	"properties": {
		"marker-symbol": "-letter"
	}
}
</maplink>
!! html/php
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10.123/20.456/en" data-zoom="13" data-lat="10.123" data-lon="20.456" data-overlays="[&quot;_83116cf234d349c9a28ff94255a598843fe4304d&quot;]">Foo</a>
</p><p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" data-overlays="[&quot;_71c9ddc35eae0a234381347ca4b7440cae1c4edd&quot;]">2</a>
</p><p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" data-overlays="[&quot;_9226ee438e3c59edfcd19e81452d7c2ba7e1d841&quot;]">A</a>
</p><p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" data-overlays="[&quot;_37e6b9ac695579cb73066fa218a00fc6ed01a04d&quot;]">B</a>
</p>
!! html/parsoid
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10.123/20.456/en" data-zoom="13" data-lat="10.123" data-lon="20.456" data-overlays='["_83116cf234d349c9a28ff94255a598843fe4304d"]' typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"latitude":"10.123","longitude":"20.456","zoom":"13","text":"Foo"},"body":{"extsrc":"\n{\n\"type\": \"Feature\",\n\t\"geometry\": {\n\t\t\"type\": \"Point\",\n\t\t\"coordinates\": [-122, 37]\n\t},\n\t\"properties\": {\n\t\t\"marker-symbol\": \"-number\"\n\t}\n}\n"}}'>Foo</a></p>

<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" data-overlays='["_83116cf234d349c9a28ff94255a598843fe4304d"]' typeof="mw:Extension/maplink" about="#mwt4" data-mw='{"name":"maplink","attrs":{"latitude":"10","longitude":"20","zoom":"13"},"body":{"extsrc":"\n{\n\"type\": \"Feature\",\n\t\"geometry\": {\n\t\t\"type\": \"Point\",\n\t\t\"coordinates\": [-122, 37]\n\t},\n\t\"properties\": {\n\t\t\"marker-symbol\": \"-number\"\n\t}\n}\n"}}'>1</a></p>

<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" data-overlays='["_9226ee438e3c59edfcd19e81452d7c2ba7e1d841"]' typeof="mw:Extension/maplink" about="#mwt6" data-mw='{"name":"maplink","attrs":{"latitude":"10","longitude":"20","zoom":"13"},"body":{"extsrc":"\n{\n\"type\": \"Feature\",\n\t\"geometry\": {\n\t\t\"type\": \"Point\",\n\t\t\"coordinates\": [-122, 37]\n\t},\n\t\"properties\": {\n\t\t\"marker-symbol\": \"-letter\"\n\t}\n}\n"}}'>A</a></p>

<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" data-overlays='["_9226ee438e3c59edfcd19e81452d7c2ba7e1d841"]' typeof="mw:Extension/maplink" about="#mwt8" data-mw='{"name":"maplink","attrs":{"latitude":"10","longitude":"20","zoom":"13","mapstyle":"osm"},"body":{"extsrc":"\n{\n\"type\": \"Feature\",\n\t\"geometry\": {\n\t\t\"type\": \"Point\",\n\t\t\"coordinates\": [-122, 37]\n\t},\n\t\"properties\": {\n\t\t\"marker-symbol\": \"-letter\"\n\t}\n}\n"}}'>A</a></p>
!! end

!! test
<maplink> - autolabelling with coordinates
!! wikitext
<maplink latitude=10 longitude=20 zoom=13 />
<maplink />
<maplink text="" />
!! html/php
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20">10°0′0″N 20°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl">0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl"></a>
</p>
!! html/parsoid
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"latitude":"10","longitude":"20","zoom":"13"}}'>10°0′0″N 20°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" typeof="mw:Extension/maplink" about="#mwt4" data-mw='{"name":"maplink","attrs":{}}'>0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" typeof="mw:Extension/maplink" about="#mwt6" data-mw='{"name":"maplink","attrs":{"text":""}}'></a></p>
!! end

!! test
<mapframe> auto-positioning
!! wikitext
<mapframe width="full" height="200">{"type":"Feature","geometry":{"type":"Point","coordinates":[1,2]}}</mapframe>
!! html/php
<div class="mw-kartographer-container mw-kartographer-full thumb tnone"><div class="thumbinner" style="width: 100%;"><a class="mw-kartographer-map" style="width: 100%; height: 200px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="200" data-overlays="[&quot;_1b3d2dce6411896528c219bf0af1e6c4c3985a1a&quot;]"><img src="https://maps.wikimedia.org/img/osm-intl,a,a,a,800x200.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=_1b3d2dce6411896528c219bf0af1e6c4c3985a1a" width="800" height="200" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,a,a,a,800x200@2x.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=_1b3d2dce6411896528c219bf0af1e6c4c3985a1a 2x" alt="Map" /></a></div></div>
!! html/parsoid
<div class="mw-kartographer-container mw-kartographer-full thumb tnone" typeof="mw:Extension/mapframe" about="#mwt2" data-mw='{"name":"mapframe","attrs":{"width":"full","height":"200"},"body":{"extsrc":"{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[1,2]}}"}}'><div class="thumbinner" style="width: 100%;"><a class="mw-kartographer-map" style="width: 100%; height: 200px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="200" data-overlays='["_1b3d2dce6411896528c219bf0af1e6c4c3985a1a"]'><img src="https://maps.wikimedia.org/img/osm-intl,a,a,a,800x200.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=_1b3d2dce6411896528c219bf0af1e6c4c3985a1a" width="800" height="200" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,a,a,a,800x200@2x.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=_1b3d2dce6411896528c219bf0af1e6c4c3985a1a 2x" alt="Map" /></a></div></div>
!! end

!! test
<maplink> - class parameter
!! wikitext
<maplink zoom=0 latitude=0 longitude=0 class="" text="Empty class - do nothing"/>
<maplink zoom=0 latitude=0 longitude=0 class="   " text="Whitespace only class - do nothing"/>
<maplink zoom=0 latitude=0 longitude=0 class="Valid-link_class_123" text="Valid class"/>
<maplink zoom=0 latitude=0 longitude=0 class="class1 class2" text="Multiple classes aren't allowed for now"/>
<maplink zoom=0 latitude=0 longitude=0 class="-Invalid-cl@ss-symbols"/>
!! html/php
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0">Empty class - do nothing</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0">Whitespace only class - do nothing</a>
<a class="mw-kartographer-maplink Valid-link_class_123" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0">Valid class</a>
</p>
<div class="mw-kartographer-error">&lt;maplink&gt;: Attribute "class" has an invalid value</div>
<div class="mw-kartographer-error">&lt;maplink&gt;: Attribute "class" has an invalid value</div>
!! html/parsoid
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","class":"","text":"Empty class - do nothing"}}'>Empty class - do nothing</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" typeof="mw:Extension/maplink" about="#mwt4" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","class":"","text":"Whitespace only class - do nothing"}}'>Whitespace only class - do nothing</a>
<a class="mw-kartographer-maplink Valid-link_class_123" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" typeof="mw:Extension/maplink" about="#mwt6" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","class":"Valid-link_class_123","text":"Valid class"}}'>Valid class</a></p>
<div class="mw-kartographer-error" typeof="mw:Extension/maplink" about="#mwt8" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","class":"class1 class2","text":"Multiple classes aren&apos;t allowed for now"}}'>&lt;maplink>: Attribute "class" has an invalid value</div>
<div class="mw-kartographer-error" typeof="mw:Extension/maplink" about="#mwt10" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","class":"-Invalid-cl@ss-symbols"}}'>&lt;maplink>: Attribute "class" has an invalid value</div>
!! end

!! test
<mapframe>
!! wikitext
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480/>
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 align=left/>
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 align=center/>
<mapframe latitude=10 longitude=20 zoom=13 width=50% height=480 align=right/>
<mapframe latitude=10 longitude=20 zoom=13 width=100% height=480/>
<mapframe latitude=10 longitude=20 zoom=13 width=full height=480/>
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480/>
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 lang=he/>
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 lang=xyz/>
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 align=left frameless />
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 align=center frameless />
<mapframe latitude=10 longitude=20 zoom=13 width=50% height=480 align=right frameless />
<mapframe latitude=10 longitude=20 zoom=13 width=100% height=480 frameless="" />
<mapframe latitude=10 longitude=20 zoom=13 width=full height=480 frameless="1" />

!! html/php
<div class="mw-kartographer-container thumb tright"><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map" /></a></div></div>
<div class="mw-kartographer-container thumb tleft"><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map" /></a></div></div>
<div class="mw-kartographer-container thumb tnone center"><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map" /></a></div></div>
<div class="mw-kartographer-container thumb tright"><div class="thumbinner" style="width: 300px;"><a class="mw-kartographer-map" style="width: 300px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480.png?lang=en" width="300" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480@2x.png?lang=en 2x" alt="Map" /></a></div></div>
<div class="mw-kartographer-container mw-kartographer-full thumb tnone"><div class="thumbinner" style="width: 100%;"><a class="mw-kartographer-map" style="width: 100%; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480.png?lang=en" width="800" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480@2x.png?lang=en 2x" alt="Map" /></a></div></div>
<div class="mw-kartographer-container mw-kartographer-full thumb tnone"><div class="thumbinner" style="width: 100%;"><a class="mw-kartographer-map" style="width: 100%; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480.png?lang=en" width="800" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480@2x.png?lang=en 2x" alt="Map" /></a></div></div>
<div class="mw-kartographer-container thumb tright"><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map" /></a></div></div>
<div class="mw-kartographer-container thumb tright"><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" data-lang="he" href="/wiki/Special:Map/13/10/20/he"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=he" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=he 2x" alt="Map" /></a></div></div>
<div class="mw-kartographer-container thumb tright"><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map" /></a></div></div>
<p><a class="mw-kartographer-map mw-kartographer-container floatleft" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map" /></a>
<a class="mw-kartographer-map mw-kartographer-container center" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map" /></a>
<a class="mw-kartographer-map mw-kartographer-container floatright" style="width: 300px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480.png?lang=en" width="300" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480@2x.png?lang=en 2x" alt="Map" /></a>
<a class="mw-kartographer-map mw-kartographer-container mw-kartographer-full" style="width: 100%; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480.png?lang=en" width="800" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480@2x.png?lang=en 2x" alt="Map" /></a>
<a class="mw-kartographer-map mw-kartographer-container mw-kartographer-full" style="width: 100%; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480.png?lang=en" width="800" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480@2x.png?lang=en 2x" alt="Map" /></a>
</p>
!! html/parsoid
<div class="mw-kartographer-container thumb tright" typeof="mw:Extension/mapframe" about="#mwt2" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"640","height":"480"}}'><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map"/></a></div></div>
<div class="mw-kartographer-container thumb tleft" typeof="mw:Extension/mapframe" about="#mwt4" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"640","height":"480","align":"left"}}'><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map"/></a></div></div>
<div class="mw-kartographer-container thumb tnone center" typeof="mw:Extension/mapframe" about="#mwt6" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"640","height":"480","align":"center"}}'><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map"/></a></div></div>
<div class="mw-kartographer-container thumb tright" typeof="mw:Extension/mapframe" about="#mwt8" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"50%","height":"480","align":"right"}}'><div class="thumbinner" style="width: 300px;"><a class="mw-kartographer-map" style="width: 300px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480.png?lang=en" width="300" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480@2x.png?lang=en 2x" alt="Map"/></a></div></div>
<div class="mw-kartographer-container mw-kartographer-full thumb tnone" typeof="mw:Extension/mapframe" about="#mwt10" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"100%","height":"480"}}'><div class="thumbinner" style="width: 100%;"><a class="mw-kartographer-map" style="width: 100%; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480.png?lang=en" width="800" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480@2x.png?lang=en 2x" alt="Map"/></a></div></div>
<div class="mw-kartographer-container mw-kartographer-full thumb tnone" typeof="mw:Extension/mapframe" about="#mwt12" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"full","height":"480"}}'><div class="thumbinner" style="width: 100%;"><a class="mw-kartographer-map" style="width: 100%; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480.png?lang=en" width="800" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480@2x.png?lang=en 2x" alt="Map"/></a></div></div>
<div class="mw-kartographer-container thumb tright" typeof="mw:Extension/mapframe" about="#mwt14" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"640","height":"480"}}'><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map"/></a></div></div>
<div class="mw-kartographer-container thumb tright" typeof="mw:Extension/mapframe" about="#mwt16" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"640","height":"480","lang":"he"}}'><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" data-lang="he" href="/wiki/Special:Map/13/10/20/he"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=he" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=he 2x" alt="Map"/></a></div></div>
<div class="mw-kartographer-container thumb tright" typeof="mw:Extension/mapframe" about="#mwt18" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"640","height":"480","lang":"xyz"}}'><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map"/></a></div></div>
<p><a class="mw-kartographer-map mw-kartographer-container floatleft" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en" typeof="mw:Extension/mapframe" about="#mwt20" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"640","height":"480","align":"left","frameless":""}}'><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map"/></a>
<a class="mw-kartographer-map mw-kartographer-container center" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en" typeof="mw:Extension/mapframe" about="#mwt22" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"640","height":"480","align":"center","frameless":""}}'><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map"/></a>
<a class="mw-kartographer-map mw-kartographer-container floatright" style="width: 300px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en" typeof="mw:Extension/mapframe" about="#mwt24" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"50%","height":"480","align":"right","frameless":""}}'><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480.png?lang=en" width="300" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480@2x.png?lang=en 2x" alt="Map"/></a>
<a class="mw-kartographer-map mw-kartographer-container mw-kartographer-full" style="width: 100%; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en" typeof="mw:Extension/mapframe" about="#mwt26" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"100%","height":"480","frameless":""}}'><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480.png?lang=en" width="800" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480@2x.png?lang=en 2x" alt="Map"/></a>
<a class="mw-kartographer-map mw-kartographer-container mw-kartographer-full" style="width: 100%; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en" typeof="mw:Extension/mapframe" about="#mwt28" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"full","height":"480","frameless":"1"}}'><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480.png?lang=en" width="800" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480@2x.png?lang=en 2x" alt="Map"/></a></p>
!! end

!! test
<mapframe> with a caption
!! wikitext
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 text="Foo is a '''bar'''" />
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 align=left text="Foo is a <b>bar</b>" />
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 align=center text="Foo is a <script>" />
<mapframe latitude=10 longitude=20 zoom=13 width=50% height=480 align=right frameless text="Frameless gets cynically ignored here" />
<mapframe latitude=10 longitude=20 zoom=13 width=100% height=480 text="Foo is a [https://example.com bar]" />
<mapframe latitude=10 longitude=20 zoom=13 width=full height=480 text="<div>Muhaha</div>" />
!! html/php
<div class="mw-kartographer-container thumb tright"><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map" /></a><div class="thumbcaption">Foo is a <b>bar</b></div></div></div>
<p>&lt;mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 align=left text="Foo is a <b>bar</b>" /&gt;
&lt;mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 align=center text="Foo is a &lt;script&gt;" /&gt;
</p>
<div class="mw-kartographer-container thumb tright"><div class="thumbinner" style="width: 300px;"><a class="mw-kartographer-map" style="width: 300px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480.png?lang=en" width="300" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480@2x.png?lang=en 2x" alt="Map" /></a><div class="thumbcaption">Frameless gets cynically ignored here</div></div></div>
<div class="mw-kartographer-container mw-kartographer-full thumb tnone"><div class="thumbinner" style="width: 100%;"><a class="mw-kartographer-map" style="width: 100%; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480.png?lang=en" width="800" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480@2x.png?lang=en 2x" alt="Map" /></a><div class="thumbcaption">Foo is a <a rel="nofollow" class="external text" href="https://example.com">bar</a></div></div></div><p>
&lt;mapframe latitude=10 longitude=20 zoom=13 width=full height=480 text="</p><div>Muhaha</div><p>" /&gt;</p>
!! html/parsoid
<div class="mw-kartographer-container thumb tright" typeof="mw:Extension/mapframe" about="#mwt2" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"640","height":"480","text":"Foo is a &apos;&apos;&apos;bar&apos;&apos;&apos;"}}'><div class="thumbinner" style="width: 640px;"><a class="mw-kartographer-map" style="width: 640px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="640" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480.png?lang=en" width="640" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,640x480@2x.png?lang=en 2x" alt="Map"/></a><div class="thumbcaption">Foo is a <b>bar</b></div></div></div>
<p>&lt;mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 align=left text="Foo is a &lt;b>bar" />
&lt;mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 align=center text="Foo is a &lt;script>" /></p>
<div class="mw-kartographer-container thumb tright" typeof="mw:Extension/mapframe" about="#mwt4" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"50%","height":"480","align":"right","frameless":"","text":"Frameless gets cynically ignored here"}}'><div class="thumbinner" style="width: 300px;"><a class="mw-kartographer-map" style="width: 300px; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480.png?lang=en" width="300" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,300x480@2x.png?lang=en 2x" alt="Map"/></a><div class="thumbcaption">Frameless gets cynically ignored here</div></div></div>
<div class="mw-kartographer-container mw-kartographer-full thumb tnone" typeof="mw:Extension/mapframe" about="#mwt6" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"100%","height":"480","text":"Foo is a [https://example.com bar]"}}'><div class="thumbinner" style="width: 100%;"><a class="mw-kartographer-map" style="width: 100%; height: 480px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="full" data-height="480" data-zoom="13" data-lat="10" data-lon="20" href="/wiki/Special:Map/13/10/20/en"><img src="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480.png?lang=en" width="800" height="480" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,13,10,20,800x480@2x.png?lang=en 2x" alt="Map"/></a><div class="thumbcaption">Foo is a <a rel="nofollow" class="external text" href="https://example.com">bar</a></div></div></div><p>
&lt;mapframe latitude=10 longitude=20 zoom=13 width=full height=480 text="&lt;div>Muhaha" /></p>
!! end

!! test
Error messages
!! wikitext
<maplink latitude=10 longitude=fail text=Derp>>Derp goes here</maplink>
<mapframe latitude=10 longitude=20 zoom=13 width=" 640	" height=480 align=crap mapstyle=derp />
<mapframe latitude=10 longitude=20 zoom=13 width=% height=480/>
<mapframe latitude=10 longitude=20 zoom=13 width=0% height=480/>
<mapframe latitude=10 longitude=20 zoom=13 width=05% height=480/>
<mapframe latitude=10 longitude=20 zoom=13 width=300% height=480/>
<mapframe latitude=10 longitude=20 zoom=13 width=640 height=480 align=crap mapstyle=derp>
{
    "type": "Feature",
    "geometry": {
      "type": "Point",
      "coordinates": [-122, 37]
    },
    "properties": {
      "title": "Foo bar",
      "marker-symbol": "museum",
      "marker-size": "medium",
      "marker-color": "fail"
    }
  }
</mapframe>
<mapframe width=200 height=200 latitude=100/>
<mapframe width=200 height=200 longitude=100/>
!! html/php
<div class="mw-kartographer-error">&lt;maplink&gt;: Attribute "longitude" has an invalid value</div>
<div class="mw-kartographer-error">&lt;mapframe&gt; problems:
<ul><li>Attribute "mapstyle" has an invalid value</li>
<li>Attribute "align" has an invalid value</li>
</ul></div>
<div class="mw-kartographer-error">&lt;mapframe&gt;: Attribute "width" has an invalid value</div>
<div class="mw-kartographer-error">&lt;mapframe&gt;: Attribute "width" has an invalid value</div>
<div class="mw-kartographer-error">&lt;mapframe&gt;: Attribute "width" has an invalid value</div>
<div class="mw-kartographer-error">&lt;mapframe&gt;: Attribute "width" has an invalid value</div>
<div class="mw-kartographer-error">&lt;mapframe&gt; problems:
<ul><li>Attribute "mapstyle" has an invalid value</li>
<li>Attribute "align" has an invalid value</li>
</ul></div>
<div class="mw-kartographer-error">&lt;mapframe&gt;: Either both "latitude" and "longitude" parameters should be supplied or neither of them</div>
<div class="mw-kartographer-error">&lt;mapframe&gt;: Either both "latitude" and "longitude" parameters should be supplied or neither of them</div>
!! html/parsoid
<div class="mw-kartographer-error" typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"latitude":"10","longitude":"fail","text":"Derp"},"body":{"extsrc":">Derp goes here"}}'>&lt;maplink>: Attribute "longitude" has an invalid value</div>
<div class="mw-kartographer-error" typeof="mw:Extension/mapframe" about="#mwt4" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"640","height":"480","align":"crap","mapstyle":"derp"}}'>&lt;mapframe> problems:
<ul><li>Attribute "mapstyle" has an invalid value</li>
<li>Attribute "align" has an invalid value</li>
</ul></div>
<div class="mw-kartographer-error" typeof="mw:Extension/mapframe" about="#mwt6" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"%","height":"480"}}'>&lt;mapframe>: Attribute "width" has an invalid value</div>
<div class="mw-kartographer-error" typeof="mw:Extension/mapframe" about="#mwt8" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"0%","height":"480"}}'>&lt;mapframe>: Attribute "width" has an invalid value</div>
<div class="mw-kartographer-error" typeof="mw:Extension/mapframe" about="#mwt10" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"05%","height":"480"}}'>&lt;mapframe>: Attribute "width" has an invalid value</div>
<div class="mw-kartographer-error" typeof="mw:Extension/mapframe" about="#mwt12" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"300%","height":"480"}}'>&lt;mapframe>: Attribute "width" has an invalid value</div>
<div class="mw-kartographer-error" typeof="mw:Extension/mapframe" about="#mwt14" data-mw='{"name":"mapframe","attrs":{"latitude":"10","longitude":"20","zoom":"13","width":"640","height":"480","align":"crap","mapstyle":"derp"},"body":{"extsrc":"\n{\n    \"type\": \"Feature\",\n    \"geometry\": {\n      \"type\": \"Point\",\n      \"coordinates\": [-122, 37]\n    },\n    \"properties\": {\n      \"title\": \"Foo bar\",\n      \"marker-symbol\": \"museum\",\n      \"marker-size\": \"medium\",\n      \"marker-color\": \"fail\"\n    }\n  }\n"}}'>&lt;mapframe> problems:
<ul><li>Attribute "mapstyle" has an invalid value</li>
<li>Attribute "align" has an invalid value</li>
</ul></div>
<div class="mw-kartographer-error" typeof="mw:Extension/mapframe" about="#mwt16" data-mw='{"name":"mapframe","attrs":{"width":"200","height":"200","latitude":"100"}}'>&lt;mapframe>: Either both "latitude" and "longitude" parameters should be supplied or neither of them</div>
<div class="mw-kartographer-error" typeof="mw:Extension/mapframe" about="#mwt18" data-mw='{"name":"mapframe","attrs":{"width":"200","height":"200","longitude":"100"}}'>&lt;mapframe>: Either both "latitude" and "longitude" parameters should be supplied or neither of them</div>
!! end

!! test
Error messages - localized
!! options
language=ru
!! wikitext
<maplink zoom=0 latitude=0 longitude=0>fail</maplink>
!! html/php
<div class="mw-kartographer-error">&lt;maplink&gt;: Ошибка JSON: Синтаксическая ошибка</div>
!! html/parsoid
<div class="mw-kartographer-error" typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0"},"body":{"extsrc":"fail"}}'>&lt;maplink>: Ошибка JSON: Синтаксическая ошибка</div>
!! end

!! test
CSS sanitization
!! wikitext
<maplink latitude=10 longitude=20 zoom=10 style="color: red;" text="<span style='foo: bar; background-image: url(https://example.com);'&gt;foo</span&gt;"/><!-- style=... was removed -->
!! html/php
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/10/10/20/en" data-zoom="10" data-lat="10" data-lon="20"><span style="/* insecure input */">foo</span></a>
</p>
!! html/parsoid
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/10/10/20/en" data-zoom="10" data-lat="10" data-lon="20" typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"latitude":"10","longitude":"20","zoom":"10","style":"color: red;","text":"&lt;span style=&apos;foo: bar; background-image: url(https://example.com);&apos;>foo&lt;/span>"}}'><span style="/* insecure input */">foo</span></a></p><!-- style=... was removed -->
!! end

!! test
<maplink> - marker styles
!! config
wgKartographerUseMarkerStyle=true
!! wikitext
<maplink latitude=10 longitude=20 zoom=13>[
{
	"type": "Feature",
	"geometry": {
		"type": "Point",
		"coordinates": [1, 2]
 	}
},
{
"type": "Feature",
	"geometry": {
		"type": "Point",
		"coordinates": [-122, 37]
	},
	"properties": {
		"marker-symbol": "-letter",
		"marker-color": "#abcdef"
	}
},
{
"type": "Feature",
	"geometry": {
		"type": "Point",
		"coordinates": [-122, 37]
	},
	"properties": {
		"marker-symbol": "-number",
		"marker-color": "#DDEEFF"
	}
}
]</maplink>
!! html/php
<p><a class="mw-kartographer-maplink mw-kartographer-autostyled" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" style="background: #abcdef;" data-overlays="[&quot;_a179016647e3e59d6050d1da013ff6b20ba0a5e2&quot;]">A</a>
</p>
!! html/parsoid
<p><a class="mw-kartographer-maplink mw-kartographer-autostyled" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" style="background: #abcdef;" data-overlays='["_a179016647e3e59d6050d1da013ff6b20ba0a5e2"]' typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"latitude":"10","longitude":"20","zoom":"13"},"body":{"extsrc":"[\n{\n\t\"type\": \"Feature\",\n\t\"geometry\": {\n\t\t\"type\": \"Point\",\n\t\t\"coordinates\": [1, 2]\n \t}\n},\n{\n\"type\": \"Feature\",\n\t\"geometry\": {\n\t\t\"type\": \"Point\",\n\t\t\"coordinates\": [-122, 37]\n\t},\n\t\"properties\": {\n\t\t\"marker-symbol\": \"-letter\",\n\t\t\"marker-color\": \"#abcdef\"\n\t}\n},\n{\n\"type\": \"Feature\",\n\t\"geometry\": {\n\t\t\"type\": \"Point\",\n\t\t\"coordinates\": [-122, 37]\n\t},\n\t\"properties\": {\n\t\t\"marker-symbol\": \"-number\",\n\t\t\"marker-color\": \"#DDEEFF\"\n\t}\n}\n]"}}'>A</a></p>
!! end

!! test
<maplink> - marker styles disabled
!! config
wgKartographerUseMarkerStyle=false
!! wikitext
<maplink latitude=10 longitude=20 zoom=13>
{
"type": "Feature",
	"geometry": {
		"type": "Point",
		"coordinates": [-122, 37]
	},
	"properties": {
		"marker-symbol": "-letter",
		"marker-color": "#abcdef"
	}
}
</maplink>
!! html/php
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" data-overlays="[&quot;_6a13e7df56bf97361c4d92be23c3d6de3311e4c8&quot;]">A</a>
</p>
!! html/parsoid
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/13/10/20/en" data-zoom="13" data-lat="10" data-lon="20" data-overlays='["_6a13e7df56bf97361c4d92be23c3d6de3311e4c8"]' typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"latitude":"10","longitude":"20","zoom":"13"},"body":{"extsrc":"\n{\n\"type\": \"Feature\",\n\t\"geometry\": {\n\t\t\"type\": \"Point\",\n\t\t\"coordinates\": [-122, 37]\n\t},\n\t\"properties\": {\n\t\t\"marker-symbol\": \"-letter\",\n\t\t\"marker-color\": \"#abcdef\"\n\t}\n}\n"}}'>A</a></p>
!! end

!! test
Wikivoyage mode enabled
!! config
wgKartographerWikivoyageMode=true
!! wikitext
<maplink zoom=0 latitude=0 longitude=0 group=ponies/>
<maplink zoom=0 latitude=0 longitude=0 show="ponies,horses"/>
<mapframe zoom=0 latitude=0 longitude=0 width=300 height=300 group=ponies>
{
"type": "Feature",
	"geometry": {
		"type": "Point",
		"coordinates": [-122, 37]
	},
	"properties": {
		"marker-symbol": "-letter",
		"marker-color": "#abcdef"
	}
}
</mapframe>
<mapframe zoom=0 latitude=0 longitude=0 width=300 height=300 show="ponies,horses"/>
!! html/php
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays="[&quot;ponies&quot;]">0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays="[&quot;ponies&quot;,&quot;horses&quot;]">0°0′0″N 0°0′0″E</a>
</p>
<div class="mw-kartographer-container thumb tright"><div class="thumbinner" style="width: 300px;"><a class="mw-kartographer-map" style="width: 300px; height: 300px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="300" data-zoom="0" data-lat="0" data-lon="0" data-overlays="[&quot;ponies&quot;]" href="/wiki/Special:Map/0/0/0/en"><img src="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=ponies" width="300" height="300" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300@2x.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=ponies 2x" alt="Map" /></a></div></div>
<div class="mw-kartographer-container thumb tright"><div class="thumbinner" style="width: 300px;"><a class="mw-kartographer-map" style="width: 300px; height: 300px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="300" data-zoom="0" data-lat="0" data-lon="0" data-overlays="[&quot;ponies&quot;,&quot;horses&quot;]" href="/wiki/Special:Map/0/0/0/en"><img src="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=ponies%2Chorses" width="300" height="300" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300@2x.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=ponies%2Chorses 2x" alt="Map" /></a></div></div>
!! html/parsoid
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays='["ponies"]' typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","group":"ponies"}}'>0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays='["ponies","horses"]' typeof="mw:Extension/maplink" about="#mwt4" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","show":"ponies,horses"}}'>0°0′0″N 0°0′0″E</a></p>
<div class="mw-kartographer-container thumb tright" typeof="mw:Extension/mapframe" about="#mwt6" data-mw='{"name":"mapframe","attrs":{"zoom":"0","latitude":"0","longitude":"0","width":"300","height":"300","group":"ponies"},"body":{"extsrc":"\n{\n\"type\": \"Feature\",\n\t\"geometry\": {\n\t\t\"type\": \"Point\",\n\t\t\"coordinates\": [-122, 37]\n\t},\n\t\"properties\": {\n\t\t\"marker-symbol\": \"-letter\",\n\t\t\"marker-color\": \"#abcdef\"\n\t}\n}\n"}}'><div class="thumbinner" style="width: 300px;"><a class="mw-kartographer-map" style="width: 300px; height: 300px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="300" data-zoom="0" data-lat="0" data-lon="0" data-overlays='["ponies"]' href="/wiki/Special:Map/0/0/0/en"><img src="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=ponies" width="300" height="300" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300@2x.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=ponies 2x" alt="Map"/></a></div></div>
<div class="mw-kartographer-container thumb tright" typeof="mw:Extension/mapframe" about="#mwt8" data-mw='{"name":"mapframe","attrs":{"zoom":"0","latitude":"0","longitude":"0","width":"300","height":"300","show":"ponies,horses"}}'><div class="thumbinner" style="width: 300px;"><a class="mw-kartographer-map" style="width: 300px; height: 300px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="300" data-zoom="0" data-lat="0" data-lon="0" data-overlays='["ponies","horses"]' href="/wiki/Special:Map/0/0/0/en"><img src="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=ponies%2Chorses" width="300" height="300" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300@2x.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=ponies%2Chorses 2x" alt="Map"/></a></div></div>
!! end

!! test
Wikivoyage mode disabled
!! config
wgKartographerWikivoyageMode=false
!! wikitext
<maplink zoom=0 latitude=0 longitude=0 group=ponies/>
<mapframe zoom=0 latitude=0 longitude=0 width=300 height=300 group=ponies>
{
"type": "Feature",
	"geometry": {
		"type": "Point",
		"coordinates": [-122, 37]
	},
	"properties": {
		"marker-symbol": "-letter",
		"marker-color": "#abcdef"
	}
}
</mapframe>
!! html/php
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0">0°0′0″N 0°0′0″E</a>
</p>
<div class="mw-kartographer-container thumb tright"><div class="thumbinner" style="width: 300px;"><a class="mw-kartographer-map" style="width: 300px; height: 300px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="300" data-zoom="0" data-lat="0" data-lon="0" data-overlays="[&quot;_6a13e7df56bf97361c4d92be23c3d6de3311e4c8&quot;]" href="/wiki/Special:Map/0/0/0/en"><img src="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=_6a13e7df56bf97361c4d92be23c3d6de3311e4c8" width="300" height="300" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300@2x.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=_6a13e7df56bf97361c4d92be23c3d6de3311e4c8 2x" alt="Map" /></a></div></div>
!! html/parsoid
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","group":"ponies"}}'>0°0′0″N 0°0′0″E</a></p>
<div class="mw-kartographer-container thumb tright" typeof="mw:Extension/mapframe" about="#mwt4" data-mw='{"name":"mapframe","attrs":{"zoom":"0","latitude":"0","longitude":"0","width":"300","height":"300","group":"ponies"},"body":{"extsrc":"\n{\n\"type\": \"Feature\",\n\t\"geometry\": {\n\t\t\"type\": \"Point\",\n\t\t\"coordinates\": [-122, 37]\n\t},\n\t\"properties\": {\n\t\t\"marker-symbol\": \"-letter\",\n\t\t\"marker-color\": \"#abcdef\"\n\t}\n}\n"}}'><div class="thumbinner" style="width: 300px;"><a class="mw-kartographer-map" style="width: 300px; height: 300px;" data-mw-kartographer="mapframe" data-style="osm-intl" data-width="300" data-height="300" data-zoom="0" data-lat="0" data-lon="0" data-overlays='["_6a13e7df56bf97361c4d92be23c3d6de3311e4c8"]' href="/wiki/Special:Map/0/0/0/en"><img src="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=_6a13e7df56bf97361c4d92be23c3d6de3311e4c8" width="300" height="300" decoding="async" srcset="https://maps.wikimedia.org/img/osm-intl,0,0,0,300x300@2x.png?lang=en&amp;domain=example.org&amp;title=Parser+test&amp;revid=1337&amp;groups=_6a13e7df56bf97361c4d92be23c3d6de3311e4c8 2x" alt="Map"/></a></div></div>
!! end

!! test
show=...
!! config
wgKartographerWikivoyageMode=true
!! wikitext
<maplink zoom=0 latitude=0 longitude=0 show="foo"/>
<maplink zoom=0 latitude=0 longitude=0 show="foo	, bar"/>
<maplink zoom=0 latitude=0 longitude=0 show="foo"/>
<maplink zoom=0 latitude=0 longitude=0 show= />
<maplink zoom=0 latitude=0 longitude=0 show=""/>
<maplink zoom=0 latitude=0 longitude=0 show='😂'/>
<maplink zoom=0 latitude=0 longitude=0 show='test-foo'/>
<maplink zoom=0 latitude=0 longitude=0 show='йа криветко'/>
!! html/php
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays="[&quot;foo&quot;]">0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays="[&quot;foo&quot;,&quot;bar&quot;]">0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays="[&quot;foo&quot;]">0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0">0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0">0°0′0″N 0°0′0″E</a>
</p>
<div class="mw-kartographer-error">&lt;maplink&gt;: Attribute "show" has an invalid value</div>
<div class="mw-kartographer-error">&lt;maplink&gt;: Attribute "show" has an invalid value</div>
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays="[&quot;йа криветко&quot;]">0°0′0″N 0°0′0″E</a>
</p>
!! html/parsoid
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays='["foo"]' typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","show":"foo"}}'>0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays='["foo","bar"]' typeof="mw:Extension/maplink" about="#mwt4" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","show":"foo , bar"}}'>0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays='["foo"]' typeof="mw:Extension/maplink" about="#mwt6" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","show":"foo"}}'>0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" typeof="mw:Extension/maplink" about="#mwt8" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","show":""}}'>0°0′0″N 0°0′0″E</a>
<a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" typeof="mw:Extension/maplink" about="#mwt10" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","show":""}}'>0°0′0″N 0°0′0″E</a></p>
<div class="mw-kartographer-error" typeof="mw:Extension/maplink" about="#mwt12" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","show":"😂"}}'>&lt;maplink>: Attribute "show" has an invalid value</div>
<div class="mw-kartographer-error" typeof="mw:Extension/maplink" about="#mwt14" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","show":"test-foo"}}'>&lt;maplink>: Attribute "show" has an invalid value</div>
<p><a class="mw-kartographer-maplink" data-mw-kartographer="maplink" data-style="osm-intl" href="/wiki/Special:Map/0/0/0/en" data-zoom="0" data-lat="0" data-lon="0" data-overlays='["йа криветко"]' typeof="mw:Extension/maplink" about="#mwt16" data-mw='{"name":"maplink","attrs":{"zoom":"0","latitude":"0","longitude":"0","show":"йа криветко"}}'>0°0′0″N 0°0′0″E</a></p>
!! end

!! test
ExternalData errors
!! wikitext
<maplink>
[
	{
		"type": "ExternalData",
		"service": "fail",
		"ids": [ "Q1", "Q2" ]
	},
	{
		"type": "ExternalData",
		"service": "lulzifier",
		"query": "test"
	}
]
</maplink>
!! html/php
<div class="mw-kartographer-error">&lt;maplink&gt;: The JSON content is not valid GeoJSON+simplestyle. The list below shows all attempts to interpret it according to <a rel="nofollow" class="external text" href="https://phabricator.wikimedia.org/diffusion/EKAR/browse/master/schemas/geojson.json">the JSON Schema</a>. Not all are errors.<ul class="mw-kartographer-error-log mw-collapsible mw-collapsed">
<li>/0/service: Does not have a value in the enumeration ["geoshape","geoline","geopoint","geomask"]</li>
<li>/0/title: The property title is required</li>
<li>/0/service: Does not have a value in the enumeration ["page"]</li>
<li>/0: Failed to match exactly one schema</li>
<li>/0/geometries: The property geometries is required</li>
<li>/0/type: Does not have a value in the enumeration ["GeometryCollection"]</li>
<li>/0/type: Does not have a value in the enumeration ["MultiPolygon"]</li>
<li>/0/type: Does not have a value in the enumeration ["Point"]</li>
<li>/0/type: Does not have a value in the enumeration ["MultiPoint"]</li>
<li>/0/type: Does not have a value in the enumeration ["LineString"]</li>
<li>/0/type: Does not have a value in the enumeration ["MultiLineString"]</li>
<li>/0/type: Does not have a value in the enumeration ["Polygon"]</li>
<li>/0/coordinates: The property coordinates is required</li>
<li>/0/geometry: The property geometry is required</li>
<li>/0/type: Does not have a value in the enumeration ["Feature"]</li>
<li>/0/features: The property features is required</li>
<li>/0/type: Does not have a value in the enumeration ["FeatureCollection"]</li>
<li>/1/service: Does not have a value in the enumeration ["geoshape","geoline","geopoint","geomask"]</li>
<li>/1/title: The property title is required</li>
<li>/1/service: Does not have a value in the enumeration ["page"]</li>
<li>/1: Failed to match exactly one schema</li>
<li>/1/geometries: The property geometries is required</li>
<li>/1/type: Does not have a value in the enumeration ["GeometryCollection"]</li>
<li>/1/type: Does not have a value in the enumeration ["MultiPolygon"]</li>
<li>/1/type: Does not have a value in the enumeration ["Point"]</li>
<li>/1/type: Does not have a value in the enumeration ["MultiPoint"]</li>
<li>/1/type: Does not have a value in the enumeration ["LineString"]</li>
<li>/1/type: Does not have a value in the enumeration ["MultiLineString"]</li>
<li>/1/type: Does not have a value in the enumeration ["Polygon"]</li>
<li>/1/coordinates: The property coordinates is required</li>
<li>/1/geometry: The property geometry is required</li>
<li>/1/type: Does not have a value in the enumeration ["Feature"]</li>
<li>/1/features: The property features is required</li>
<li>/1/type: Does not have a value in the enumeration ["FeatureCollection"]</li>
</ul></div>
!! html/parsoid
<div class="mw-kartographer-error" typeof="mw:Extension/maplink" about="#mwt2" data-mw='{"name":"maplink","attrs":{},"body":{"extsrc":"\n[\n\t{\n\t\t\"type\": \"ExternalData\",\n\t\t\"service\": \"fail\",\n\t\t\"ids\": [ \"Q1\", \"Q2\" ]\n\t},\n\t{\n\t\t\"type\": \"ExternalData\",\n\t\t\"service\": \"lulzifier\",\n\t\t\"query\": \"test\"\n\t}\n]\n"}}'>&lt;maplink>: The JSON content is not valid GeoJSON+simplestyle. The list below shows all attempts to interpret it according to <a rel="nofollow" class="external text" href="https://phabricator.wikimedia.org/diffusion/EKAR/browse/master/schemas/geojson.json">the JSON Schema</a>. Not all are errors.<ul class="mw-kartographer-error-log mw-collapsible mw-collapsed">
<li>/0/service: Does not have a value in the enumeration ["geoshape","geoline","geopoint","geomask"]</li>
<li>/0/title: The property title is required</li>
<li>/0/service: Does not have a value in the enumeration ["page"]</li>
<li>/0: Failed to match exactly one schema</li>
<li>/0/geometries: The property geometries is required</li>
<li>/0/type: Does not have a value in the enumeration ["GeometryCollection"]</li>
<li>/0/type: Does not have a value in the enumeration ["MultiPolygon"]</li>
<li>/0/type: Does not have a value in the enumeration ["Point"]</li>
<li>/0/type: Does not have a value in the enumeration ["MultiPoint"]</li>
<li>/0/type: Does not have a value in the enumeration ["LineString"]</li>
<li>/0/type: Does not have a value in the enumeration ["MultiLineString"]</li>
<li>/0/type: Does not have a value in the enumeration ["Polygon"]</li>
<li>/0/coordinates: The property coordinates is required</li>
<li>/0/geometry: The property geometry is required</li>
<li>/0/type: Does not have a value in the enumeration ["Feature"]</li>
<li>/0/features: The property features is required</li>
<li>/0/type: Does not have a value in the enumeration ["FeatureCollection"]</li>
<li>/1/service: Does not have a value in the enumeration ["geoshape","geoline","geopoint","geomask"]</li>
<li>/1/title: The property title is required</li>
<li>/1/service: Does not have a value in the enumeration ["page"]</li>
<li>/1: Failed to match exactly one schema</li>
<li>/1/geometries: The property geometries is required</li>
<li>/1/type: Does not have a value in the enumeration ["GeometryCollection"]</li>
<li>/1/type: Does not have a value in the enumeration ["MultiPolygon"]</li>
<li>/1/type: Does not have a value in the enumeration ["Point"]</li>
<li>/1/type: Does not have a value in the enumeration ["MultiPoint"]</li>
<li>/1/type: Does not have a value in the enumeration ["LineString"]</li>
<li>/1/type: Does not have a value in the enumeration ["MultiLineString"]</li>
<li>/1/type: Does not have a value in the enumeration ["Polygon"]</li>
<li>/1/coordinates: The property coordinates is required</li>
<li>/1/geometry: The property geometry is required</li>
<li>/1/type: Does not have a value in the enumeration ["Feature"]</li>
<li>/1/features: The property features is required</li>
<li>/1/type: Does not have a value in the enumeration ["FeatureCollection"]</li>
</ul></div>
!! end
